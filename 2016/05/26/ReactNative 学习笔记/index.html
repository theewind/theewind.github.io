<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>React Native学习笔记 | sanfeng’s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="在学习react Native的过程中，对一些知识的记录，不定期更新。。。
1. React 里直接修改 this.state 和调用 setState() 修改 state 的值有什么区别？https://segmentfault.com/q/1010000002958584
使用对this.state赋值并没有什么作用，官方提醒，应该把this.state当成不可变变量。而使用this.set">
<meta property="og:type" content="article">
<meta property="og:title" content="React Native学习笔记">
<meta property="og:url" content="http://theewind.github.io/2016/05/26/ReactNative 学习笔记/index.html">
<meta property="og:site_name" content="sanfeng’s blog">
<meta property="og:description" content="在学习react Native的过程中，对一些知识的记录，不定期更新。。。
1. React 里直接修改 this.state 和调用 setState() 修改 state 的值有什么区别？https://segmentfault.com/q/1010000002958584
使用对this.state赋值并没有什么作用，官方提醒，应该把this.state当成不可变变量。而使用this.set">
<meta property="og:updated_time" content="2016-06-01T07:22:23.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="React Native学习笔记">
<meta name="twitter:description" content="在学习react Native的过程中，对一些知识的记录，不定期更新。。。
1. React 里直接修改 this.state 和调用 setState() 修改 state 的值有什么区别？https://segmentfault.com/q/1010000002958584
使用对this.state赋值并没有什么作用，官方提醒，应该把this.state当成不可变变量。而使用this.set">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xthb9.com2.z0.glb.clouddn.com/8d04d7630ea03c7524cff3437f48e009.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">sanfeng.li</a></h1>
		</hgroup>

		
		<p class="header-subtitle">sanfengflying</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/">标签云</a></li>
				        
							<li><a href="/tags/swift">swift</a></li>
				        
							<li><a href="/about">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/theewind" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:sanfengflying@126.com" title="mail">mail</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
								<a class="Sitemap" target="_blank" href="/sitemap.xml" title="Sitemap">Sitemap</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/RAC/" style="font-size: 10px;">RAC</a> <a href="/tags/React-Native/" style="font-size: 13.33px;">React Native</a> <a href="/tags/WKWebView/" style="font-size: 10px;">WKWebView</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/tags/iOS/" style="font-size: 20px;">iOS</a> <a href="/tags/javascript-前端/" style="font-size: 10px;">javascript 前端</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/qrcode/" style="font-size: 10px;">qrcode</a> <a href="/tags/react-native/" style="font-size: 13.33px;">react native</a> <a href="/tags/shell/" style="font-size: 13.33px;">shell</a> <a href="/tags/swift/" style="font-size: 10px;">swift</a> <a href="/tags/代码检测/" style="font-size: 10px;">代码检测</a> <a href="/tags/前端/" style="font-size: 16.67px;">前端</a> <a href="/tags/正则表达式/" style="font-size: 10px;">正则表达式</a> <a href="/tags/测试/" style="font-size: 10px;">测试</a> <a href="/tags/缓存/" style="font-size: 10px;">缓存</a> <a href="/tags/脚本/" style="font-size: 10px;">脚本</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">三风，江湖人称风风子，我就是是我，不一样的烟火~~~</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">sanfeng.li</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://7xthb9.com2.z0.glb.clouddn.com/8d04d7630ea03c7524cff3437f48e009.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">sanfeng.li</h1>
			</hgroup>
			
			<p class="header-subtitle">sanfengflying</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/">标签云</a></li>
		        
					<li><a href="/tags/swift">swift</a></li>
		        
					<li><a href="/about">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/theewind" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:sanfengflying@126.com" title="mail">mail</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
						<a class="Sitemap" target="_blank" href="/sitemap.xml" title="Sitemap">Sitemap</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-ReactNative 学习笔记" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/26/ReactNative 学习笔记/" class="article-date">
  	<time datetime="2016-05-26T06:36:44.000Z" itemprop="datePublished">2016-05-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      React Native学习笔记
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React-Native/">React Native</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在学习react Native的过程中，对一些知识的记录，不定期更新。。。</p>
<h2 id="1-React-里直接修改-this-state-和调用-setState-修改-state-的值有什么区别？"><a href="#1-React-里直接修改-this-state-和调用-setState-修改-state-的值有什么区别？" class="headerlink" title="1. React 里直接修改 this.state 和调用 setState() 修改 state 的值有什么区别？"></a>1. React 里直接修改 this.state 和调用 setState() 修改 state 的值有什么区别？</h2><p><a href="https://segmentfault.com/q/1010000002958584" target="_blank" rel="external">https://segmentfault.com/q/1010000002958584</a></p>
<p>使用对this.state赋值并没有什么作用，官方提醒，应该把this.state当成不可变变量。<br>而使用this.setState方法，会触发异步修改状态，状态改变的同时，会重新执行一次willUpdate，render等流程。需要注意的是，避免在执行完this.setState后马上读取this.state，此操作并不会获得最新修改的状态。</p>
<a id="more"></a>
<blockquote>
<p>Notes:<br>NEVER mutate this.state directly, as calling setState() afterwards may replace the mutation you made. Treat this.state as if it were immutable.<br>setState() does not immediately mutate this.state but creates a pending state transition. Accessing this.state after calling this method can potentially return the existing value.<br>There is no guarantee of synchronous operation of calls to setState and calls may be batched for performance gains.<br>setState() will always trigger a re-render unless conditional rendering logic is implemented in shouldComponentUpdate(). If mutable objects are being used and the logic cannot be implemented in shouldComponentUpdate(), calling setState() only when the new state differs from the previous state will avoid unnecessary re-renders.</p>
</blockquote>
<h2 id="2-react-native-vector-icons"><a href="#2-react-native-vector-icons" class="headerlink" title="2. react-native-vector-icons"></a>2. react-native-vector-icons</h2><p>react-native-icons 是 React Native 简单易用的图标组件。</p>
<p>当前支持 4 种字体：</p>
<ul>
<li>FontAwesome 4.2 Contains 479 icons</li>
<li>ionicons 2.0.0 Contains 733 icons, lots of iOS 7 style outlined icons.</li>
<li>Foundation icons Contains 283 icons.</li>
<li>Zocial Contains 99 social icons.</li>
</ul>
<p>因为在RN中没有Button，可以采用react-native-vector-icons替换，包括TabBarItem等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import FontAwesome from &apos;react-naitive-vector-icons/FontAwesome&apos;;</span><br><span class="line">&lt;FontAwesome.TabBarItem</span><br><span class="line">	key = &#123;i&#125;</span><br><span class="line">	title = &#123;controller.title&#125;</span><br><span class="line">	selected = &#123;this.state.selectedTab === controller.title&#125;</span><br><span class="line">	iconName = &#123;controller.icon&#125;</span><br><span class="line">	onPress = &#123;() =&gt; &#123;</span><br><span class="line">		this.setState(&#123;</span><br><span class="line">			selectedTab: controller.title</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">&lt;Component navigator = &#123;this.props.navigator&#125; /&gt;</span><br><span class="line">&lt;/FontAwesome.TabBarItem&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import Icon from &apos;react-native-vector-icons/Ionicons&apos;;</span><br><span class="line"></span><br><span class="line">function TabBarView(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;TabBarIOS&gt;</span><br><span class="line">      &lt;Icon.TabBarItem</span><br><span class="line">        title=&quot;Home&quot;</span><br><span class="line">        iconName=&quot;ios-home-outline&quot;</span><br><span class="line">        selectedIconName=&quot;ios-home&quot;</span><br><span class="line">        &gt;</span><br><span class="line">        &lt;View style=&#123;styles.tabContent&#125;&gt;&lt;Text&gt;Home Tab&lt;/Text&gt;&lt;/View&gt;</span><br><span class="line">      &lt;/Icon.TabBarItem&gt;</span><br><span class="line">    &lt;/TabBarIOS&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-cloneWithRows"><a href="#3-cloneWithRows" class="headerlink" title="3. cloneWithRows"></a>3. cloneWithRows</h2><p>一般我们都是这样写ListViewDataSource的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">let ds = new ListView.DataSource(&#123;</span><br><span class="line">  rowHasChanged: (r1, r2) =&gt; r1 !== r2</span><br><span class="line">&#125;);</span><br><span class="line">this.state = &#123;</span><br><span class="line">  dataSource: ds.cloneWithRows(menuCategroys),</span><br><span class="line">&#125;</span><br><span class="line">而不是这样：</span><br><span class="line">this.state = &#123;</span><br><span class="line">    dataSource: new ListView.DataSource(&#123;</span><br><span class="line">        rowHasChanged: (row1, row2) =&gt; row1 !== row2,</span><br><span class="line">    &#125;),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主要是因为，cloneWithRows不仅仅是赋值数据，还会有一些对比操作，判断里面的rowdata是否有更新等操作。</p>
<blockquote>
<p><a href="http://stackoverflow.com/questions/29351259/how-to-add-delete-item-into-listview" target="_blank" rel="external">How to add/Delete item into ListView?</a></p>
</blockquote>
<h2 id="4-onLayout方法"><a href="#4-onLayout方法" class="headerlink" title="4. onLayout方法"></a>4. onLayout方法</h2><p><strong>onLayout</strong> <em>function</em> </p>
<p>当组件挂载或者布局变化的时候调用，参数为：</p>
<p>{nativeEvent: { layout: {x, y, width, height}}}</p>
<p>这个事件会在布局计算完成后立即调用一次，不过收到此事件时新的布局可能还没有在屏幕上呈现，尤其是一个布局动画正在进行中的时候。    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">onLayout=&#123;(event) =&gt; &#123;</span><br><span class="line">          var layout = event.nativeEvent.layout;</span><br><span class="line">          this.setState(&#123;</span><br><span class="line">              listHeight : layout.height</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>对于ListView来说，滑动的过程中不会重新调用onLayout，所以这里的listHeight始终不变，不能用来监控滑动。</p>
<h2 id="5-this-setState"><a href="#5-this-setState" class="headerlink" title="5. this.setState"></a>5. this.setState</h2><p>this.setState设置一个参数形式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;CategoryMenu</span><br><span class="line">                    key=&#123;&apos;category_menu&apos;&#125;</span><br><span class="line">                    categories=&#123;this.state.newsCategories&#125;</span><br><span class="line">                    fetchNewsList=&#123;(category) =&gt; &#123;</span><br><span class="line">                        this.setState(&#123;</span><br><span class="line">                            currentCategory: category,</span><br><span class="line">                            isRefreshing: true,</span><br><span class="line">                        &#125;,  function() &#123;</span><br><span class="line">                            this._fetchNewsList();</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;&#125;</span><br><span class="line">                /&gt;</span><br></pre></td></tr></table></figure>
<p>在CategoryMenu中传入key（默认的props属性），categories获取的分类，已经方法fetchNewsList，而fetchNewList方法主要是更新自身的state，并发送请求，更新state属性，并调用某个方法。因为上述要点1中说过，setState并不会立即生效，调用this.state可能还是就的数据，既可以通过这种方式立即出发自己的某些操作。比如此处的_fetchNewsList，如果currentCategory没有生效，可以把catetory当做参数传递过去。</p>
<h2 id="6-render方法如何根据条件进行渲染"><a href="#6-render方法如何根据条件进行渲染" class="headerlink" title="6. render方法如何根据条件进行渲染"></a>6. render方法如何根据条件进行渲染</h2><p>在render（）方法里面，经常遇到的就是根据条件进行渲染，特别是对于彼此之间有显示隐藏逻辑，这时候如果把所有view都绘制出来，然后布局，显然比较复杂，这时就可以采用分条件布局的方式。简单说就是先声明一个数组，然后根据各种逻辑，进行push操作，把各种view push进之前的数组中，最后，渲染那个view的数组就可以了。<br>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">        let NavigationBar = [];</span><br><span class="line"></span><br><span class="line">        // 左边图片按钮</span><br><span class="line">        if (this.props.leftIcon != undefined) &#123;</span><br><span class="line">            NavigationBar.push(</span><br><span class="line">                &lt;TouchableOpacity</span><br><span class="line">                    key=&#123;&apos;leftIcon&apos;&#125;</span><br><span class="line">                    activeOpacity=&#123;0.75&#125;</span><br><span class="line">                    style=&#123;styles.leftIcon&#125;</span><br><span class="line">                    onPress=&#123;this.props.leftTouchAction&#125;</span><br><span class="line">                &gt;</span><br><span class="line">                    &lt;Icon color=&quot;white&quot; size=&#123;30&#125; name=&#123;this.props.leftIcon&#125;/&gt;</span><br><span class="line">                &lt;/TouchableOpacity&gt;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 标题</span><br><span class="line">        if (this.props.title != undefined) &#123;</span><br><span class="line">            NavigationBar.push(</span><br><span class="line">                &lt;Text key=&#123;&apos;title&apos;&#125; style=&#123;styles.title&#125;&gt;&#123;this.props.title&#125;&lt;/Text&gt;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 自定义标题View</span><br><span class="line">        if (this.props.titleView != undefined) &#123;</span><br><span class="line">            let Component = this.props.titleView;</span><br><span class="line">            </span><br><span class="line">            NavigationBar.push(</span><br><span class="line">                &lt;Component key=&#123;&apos;titleView&apos;&#125; /&gt;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 右边图片按钮</span><br><span class="line">        if (this.props.rightIcon != undefined) &#123;</span><br><span class="line">            NavigationBar.push(</span><br><span class="line">                &lt;TouchableOpacity</span><br><span class="line">                    key=&#123;&apos;rightIcon&apos;&#125;</span><br><span class="line">                    activeOpacity=&#123;0.75&#125;</span><br><span class="line">                    style=&#123;styles.rightIcon&#125;</span><br><span class="line">                    onPress=&#123;this.props.rightTouchAction&#125;</span><br><span class="line">                &gt;</span><br><span class="line">                    &lt;Icon color=&quot;white&quot; size=&#123;30&#125; name=&#123;this.props.rightIcon&#125;/&gt;</span><br><span class="line">                &lt;/TouchableOpacity&gt;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 右边文字按钮</span><br><span class="line">        if (this.props.rightButton != undefined) &#123;</span><br><span class="line">            NavigationBar.push(</span><br><span class="line">                &lt;TouchableOpacity</span><br><span class="line">                    key=&#123;&apos;rightButton&apos;&#125;</span><br><span class="line">                    activeOpacity=&#123;0.75&#125;</span><br><span class="line">                    style=&#123;styles.rightButton&#125;</span><br><span class="line">                    onPress=&#123;this.props.rightButtonAction&#125;</span><br><span class="line">                &gt;</span><br><span class="line">                    &lt;Text style=&#123;styles.buttonTitleFont&#125;&gt;&#123;this.props.rightButton&#125;&lt;/Text&gt;</span><br><span class="line">                &lt;/TouchableOpacity&gt;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return (</span><br><span class="line">            &lt;View style=&#123;styles.header&#125;&gt;</span><br><span class="line">                &lt;View style=&#123;styles.navigationBarContainer&#125;&gt;</span><br><span class="line">                    &#123;NavigationBar&#125;</span><br><span class="line">                &lt;/View&gt;</span><br><span class="line">            &lt;/View&gt;</span><br><span class="line">        )</span><br><span class="line">根据条件进行push操作，得到一个渲染列表。</span><br></pre></td></tr></table></figure>
<p>还有一种方式是通过，匿名函数的方式，返回一个个的view，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">const secondLine = (</span><br><span class="line">      &lt;View style = &#123;styles.secondLineView&#125;&gt;</span><br><span class="line">        &#123;(()=&gt;&#123;</span><br><span class="line">          if (spu.recomCount &gt; 0) &#123;</span><br><span class="line">            return (</span><br><span class="line">              &lt;View style style = &#123;styles.rowView&#125;&gt;</span><br><span class="line">                &lt;Image source=&#123;require(&apos;../../../asset/od_icon_smallzan.png&apos;)&#125; style = &#123;styles.imageLike&#125;&gt;&lt;/Image&gt;</span><br><span class="line">                &lt;Text style = &#123;[styles.detailText,styles.liketext]&#125;&gt;&#123;spu.recomCount&#125;&lt;/Text&gt;</span><br><span class="line">              &lt;/View&gt;</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)()&#125;</span><br><span class="line">        &#123;(()=&gt;&#123;</span><br><span class="line">          if (spu.dishSales &amp;&amp; spu.dishSales.length &gt; 0) &#123;</span><br><span class="line">            return(</span><br><span class="line">              &lt;View&gt;</span><br><span class="line">                &lt;Text style = &#123;styles.detailText&#125;&gt;&#123;spu.dishSales&#125;&lt;/Text&gt;</span><br><span class="line">              &lt;/View&gt;</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)()&#125;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>
<h2 id="7-字体使用：ionIcons-amp-AwesomeFont"><a href="#7-字体使用：ionIcons-amp-AwesomeFont" class="headerlink" title="7. 字体使用：ionIcons &amp; AwesomeFont"></a>7. 字体使用：ionIcons &amp; AwesomeFont</h2><p>ionicons 包含超过 430 个免费漂亮的程序图标。该图标集采用 MIT 许可证，你可在商业应用中使用。它和AwesomeFont的字体就是矢量图,无论是放大还是缩小都不失真的矢量图哦。不仅是在ReactNative中使用，即使是iOS native开发中，也可以使用的。<br>可以导入FontAwesomeKit框架。更高级的方式，是把字体转换成路径，然后就可以执行各种CoreAnimation的动画了。<a href="http://www.tuicool.com/articles/2MJNZn" target="_blank" rel="external">参考动画</a></p>
<p>而在使用的过程中，只要导入：</p>
<pre><code>import Icon from &apos;react-native-vector-icons/Ionicons&apos;;
import IconFA from &apos;react-native-vector-icons/FontAwesome&apos;;
然后自己定义属性：
{
    key:28,
    title:&quot;iMessage image picker&quot;,
    component: Day29,
    isFA: false,
    icon: &quot;navicon-round&quot;,
    size:50,
    color:&quot;#48f52e&quot;,
    hideNav: false,
  },{
    key:29,
    title:&quot;Push Notifications&quot;,
    component: Day30,
    isFA: false,
    icon: &quot;android-notifications&quot;,
    size:50,
    color:&quot;#f27405&quot;,
    hideNav: false,
  }]

  render方法里面调用：
  {elem.isFA? &lt;IconFA size={elem.size} name={elem.icon} style={[styles.boxIcon,{color:elem.color}]}&gt;&lt;/IconFA&gt;:
          &lt;Icon size={elem.size} name={elem.icon} style={[styles.boxIcon,{color:elem.color}]}&gt;&lt;/Icon&gt;}
</code></pre><h2 id="8-如何从listView中获取scrollView的属性"><a href="#8-如何从listView中获取scrollView的属性" class="headerlink" title="8. 如何从listView中获取scrollView的属性"></a>8. 如何从listView中获取scrollView的属性</h2><p>需要定义ref</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;ListView</span><br><span class="line">        ref=&quot;listView&quot;</span><br><span class="line">        dataSource=&#123;this.state.dataSource&#125;</span><br><span class="line">        renderRow=&#123;this._renderRow</span><br><span class="line">        onScroll=&#123;this.handleScroll&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/View&gt;</span><br></pre></td></tr></table></figure>
<p>然后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">      var scrollProperties = this.refs.listView.scrollProperties;</span><br><span class="line">      console.log(scrollProperties);</span><br><span class="line">      console.log(scrollProperties.offset);</span><br><span class="line">      </span><br><span class="line">      手动滚动到某处</span><br><span class="line">componentDidUpdate() &#123;</span><br><span class="line">    let scrollResponder = this.refs.listView.getScrollResponder();</span><br><span class="line">    scrollResponder.scrollResponderScrollTo(&#123;x: 0, y:this.pscroll(), animated: true&#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>通过scrollProperties，然后就可以获取offset了。<br>还有一种方式是通过：event.nativeEvent.contentOffset.y获得。参考</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">handleScroll: function(event: Object) &#123;</span><br><span class="line"></span><br><span class="line">    if (event.nativeEvent.contentOffset.y &lt; -110) &#123; // pull-down</span><br><span class="line">        this.setState(&#123;isLoading: true&#125;);</span><br><span class="line">        var filter = this.props.filter || this.state.filter;</span><br><span class="line">        // reduce dup fetches</span><br><span class="line">        this.clearTimeout(this.timeoutID);</span><br><span class="line">        this.timeoutID = this.setTimeout(() =&gt; this.fetchVideos(filter), 250);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/06/03/doubleListViewDemo/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          React Native 双listView交互动画
        
      </div>
    </a>
  
  
    <a href="/2016/05/26/iOS下载内容保存在document中需要设置不同步/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">iOS下载内容保存在document中需要设置不同步</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
    <a class="jiathis_button_twitter"></a>
    <a class="jiathis_button_plus"></a> 
    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="ReactNative 学习笔记" data-title="React Native学习笔记" data-url="http://theewind.github.io/2016/05/26/ReactNative 学习笔记/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"theewind"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 sanfeng.li
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: flase
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>